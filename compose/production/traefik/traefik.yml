log:
  level: INFO

accessLog:
  filePath: /var/log/traefik/access.log
  bufferingSize: 100

entryPoints:
  web:
    address: ":80"
    # forwardedHeaders: # necessary to trust X-Forwarded-For headers generated by Nginx
    #   trustedIPs:
    #     # - "127.0.0.1/32"
    #     # - "172.21.1.14"
    #     - "172.22.0.1" # ip address generated by the docker network, i could find a way of trusting the real host IP
    #                    # this has the side effect of allowing attackers to forge X-Forward-* headers like this:
    #                    #    curl --header "X-Forwarded-For: 192.168.0.2" https://accounts-dev.embo.org/admin
    #                    # However, in the particular case of X-Forwarded-For, NGINX can be configured in production
    #                    # to overwrite it with the real IP.
    #                    # With this trick, ip-whitelisting by traefik seems reliable and secure, but i'm not sure
    #                    # if this opened other kind of attacks
  web-secure:
    # https
    address: ":443"

certificatesResolvers:
  letsencrypt:
    # https://docs.traefik.io/master/https/acme/#lets-encrypt
    acme:
      email: "embo_it@embo.org"
      storage: /etc/traefik/acme/acme.json
      # https://docs.traefik.io/master/https/acme/#httpchallenge
      httpChallenge:
        entryPoint: web

providers:
  # https://docs.traefik.io/master/providers/file/
  file:
    filename: /etc/traefik/traefik.dynamic.yml
    watch: 'false'
#api:
#  insecure: true # for web UI debugging
#  debug: true
#log:
#  level: DEBUG
